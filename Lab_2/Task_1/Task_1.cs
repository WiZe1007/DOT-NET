using System; // Підключення простору імен System

class Task_1 // Оголошення класу Task_1
{
    static void Main() // Головний метод програми
    {
        Console.InputEncoding = System.Text.Encoding.UTF8; // Встановлення кодування для вводу
        Console.OutputEncoding = System.Text.Encoding.UTF8; // Встановлення кодування для виводу

        int[] array = new int[200]; // Оголошення масиву з 200 елементів
        Random rand = new Random(); // Створення об'єкта для генерації випадкових чисел

        // Заповнення масиву випадковими значеннями від -100 до 100
        for (int i = 0; i < array.Length; i++)
        {
            array[i] = rand.Next(-100, 101); // Присвоєння випадкового значення елементу масиву
        }

        Console.WriteLine("Початковий масив:"); // Виведення повідомлення
        PrintArray(array); // Виклик методу для виведення масиву

        // Обробка масиву
        ProcessArray(array); // Виклик методу для обробки масиву

        Console.WriteLine("\nМасив після обробки:"); // Виведення повідомлення
        PrintArray(array); // Виклик методу для виведення масиву

        Console.ReadKey(); // Очікування натискання клавіші
    }

    static void ProcessArray(int[] array) // Метод для обробки масиву
    {
        int start = -1; // Початковий індекс послідовності невід'ємних чисел
        int end = -1; // Кінцевий індекс послідовності невід'ємних чисел
        int sum = 0; // Сума невід'ємних чисел
        int count = 0; // Кількість невід'ємних чисел

        for (int i = 0; i < array.Length; i++) // Прохід по всіх елементах масиву
        {
            if (array[i] >= 0) // Якщо елемент невід'ємний
            {
                if (start == -1) // Якщо це початок нової послідовності
                {
                    start = i; // Встановлення початкового індексу
                }
                end = i; // Оновлення кінцевого індексу
                sum += array[i]; // Додавання елемента до суми
                count++; // Збільшення лічильника
            }
            else // Якщо елемент від'ємний
            {
                if (count > 1) // Якщо в послідовності більше одного елемента
                {
                    int average = sum / count; // Обчислення середнього значення
                    int maxIndex = start; // Індекс максимального елемента
                    int minIndex = start; // Індекс мінімального елемента

                    for (int j = start; j <= end; j++) // Прохід по послідовності
                    {
                        if (array[j] > array[maxIndex]) // Якщо елемент більший за поточний максимум
                        {
                            maxIndex = j; // Оновлення індексу максимуму
                        }
                        if (array[j] < array[minIndex]) // Якщо елемент менший за поточний мінімум
                        {
                            minIndex = j; // Оновлення індексу мінімуму
                        }
                    }

                    array[maxIndex] = average; // Заміна максимального елемента на середнє значення
                    array[minIndex] = average; // Заміна мінімального елемента на середнє значення
                }

                start = -1; // Скидання початкового індексу
                end = -1; // Скидання кінцевого індексу
                sum = 0; // Скидання суми
                count = 0; // Скидання лічильника
            }
        }

        // Обробка останньої послідовності, якщо вона існує
        if (count > 1) // Якщо в послідовності більше одного елемента
        {
            int average = sum / count; // Обчислення середнього значення
            int maxIndex = start; // Індекс максимального елемента
            int minIndex = start; // Індекс мінімального елемента

            for (int j = start; j <= end; j++) // Прохід по послідовності
            {
                if (array[j] > array[maxIndex]) // Якщо елемент більший за поточний максимум
                {
                    maxIndex = j; // Оновлення індексу максимуму
                }
                if (array[j] < array[minIndex]) // Якщо елемент менший за поточний мінімум
                {
                    minIndex = j; // Оновлення індексу мінімуму
                }
            }

            array[maxIndex] = average; // Заміна максимального елемента на середнє значення
            array[minIndex] = average; // Заміна мінімального елемента на середнє значення
        }
    }

    static void PrintArray(int[] array) // Метод для виведення масиву
    {
        foreach (int value in array) // Прохід по всіх елементах масиву
        {
            Console.Write(value + " "); // Виведення елемента
        }
        Console.WriteLine(); // Перехід на новий рядок
    }
}

